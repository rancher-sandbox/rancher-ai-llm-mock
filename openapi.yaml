openapi: 3.0.3
info:
  title: LLM Mock Service
  version: 1.0.0
  description: Mock endpoints for LLM API compatibility (Ollama, Gemini, OpenAI, AWS Bedrock)
servers:
  - url: http://localhost:8083
tags:
  - name: Control API
    description: Endpoints for controlling the mock service (push/clear queue)
  - name: Models API
    description: Endpoints for model-compatible chat APIs (Ollama, Gemini, OpenAI, AWS Bedrock)
paths:
  /v1/control/push:
    post:
      summary: Push mock response(s) to the queue
      description: |
        Payload validation rules:
        - At least one of `text` or a valid `tool` must be present.
        - Valide tool must provide `tool.name` and `tool.args`.
      tags:
        - Control API
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/MockResponse'
                - type: array
                  items:
                    $ref: '#/components/schemas/MockResponse'
      responses:
        '204':
          description: No Content
  /v1/control/clear:
    post:
      summary: Clear mock response queue
      tags:
        - Control API
      responses:
        '204':
          description: No Content
  /api/chat:
    post:
      summary: Ollama mock endpoint
      tags:
        - Models API
      responses:
        '200':
          description: Streamed chat response
          content:
            application/json:
              schema:
                type: object
                properties:
                  model:
                    type: string
                  created_at:
                    type: string
                  message:
                    type: object
                  done:
                    type: boolean
  /v1beta/models/{path}:
    post:
      summary: Gemini mock endpoint
      tags:
        - Models API
      parameters:
          - in: path
            name: path
            required: true
            description: |
              Path parameter in the format {model}:{api-name}, e.g. gemini-flash-2.0:streamGenerateContent
            schema:
              type: string
      responses:
        '200':
          description: Streamed Gemini response (JSON or SSE)
          content:
            application/json:
              schema:
                type: object
                properties:
                  candidates:
                    type: array
                    items:
                      type: object
                  modelVersion:
                    type: string
                  responseId:
                    type: string
  /chat/completions:
    post:
      summary: OpenAI mock completions
      tags:
        - Models API
      responses:
        '200':
          description: Streamed OpenAI chat response (SSE)
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  object:
                    type: string
                  created:
                    type: integer
                  model:
                    type: string
                  choices:
                    type: array
                    items:
                      type: object
  /model/{model}/converse:
    post:
      summary: Bedrock mock Converse endpoint
      tags:
        - Models API
      parameters:
          - in: path
            name: model
            required: true
            description: Bedrock model name
            schema:
              type: string
      responses:
        '200':
          description: Streamed Bedrock Converse response (JSON)
          content:
            application/json:
              schema:
                type: object
                properties:
                  output:
                    type: object
                    properties:
                      message:
                        type: object
                        properties:
                          role:
                            type: string
                          content:
                            type: array
                            items:
                              oneOf:
                                - type: object
                                  properties:
                                    text:
                                      type: string
                                - type: object
                                  properties:
                                    toolUse:
                                      type: object
                                      properties:
                                        id:
                                          type: string
                                        type:
                                          type: string
                                        name:
                                          type: string
                                        arguments:
                                          type: object
                      stopReason:
                        type: string
                      usage:
                        type: object
                        properties:
                          inputTokens:
                            type: integer
                          outputTokens:
                            type: integer
                          totalTokens:
                            type: integer
components:
  schemas:
    MockResponse:
      type: object
      properties:
        text:
          type: object
          properties:
            chunks:
              type: array
              items:
                type: string
        tool:
          type: object
          properties:
            name:
              type: string
            args:
              type: object
      required:
        - text
